# ðŸš€ Level Up: More Awesome Features!
Welcome back, adventurer! ðŸ† We've already packed a lot of magic into our App() function, but why stop here? Let's take things up a notch by adding new functionalities that make our app even more powerful!

## ðŸ—ï¸ Summon Your NFT â€“ requestNFT()

Let's build the logic to request an NFT. Add the following code before the `return` statement in your `App()` function:

```javascript
const requestNFT = () => {
    if (!userName) {
      alert("Please enter your name first!");
      return;
    }

    setLoading(true);
    playThinkingSound();

    randomHouseContract.methods
      .requestNFT(userName)
      .send({ from: account, value: web3.utils.toWei("0", "ether") })
      .on("transactionHash", function (hash) {
        console.log("Transaction sent. Transaction hash:", hash);
        setDisplayCounter(true);
      })
      .on("receipt", async function (receipt) {
        console.log("Transaction successful:", receipt.transactionHash);
        try {
          console.log('Starting NFT minting process...');
          await checkNewMinted();
        } catch (error) {
          console.error('Error in minting process:', error);
        } finally {
          setLoading(false);
          setDisplayCounter(false);
        }
      })
      .on("error", (error) => {
        console.error("Error requesting NFT:", error);
        setLoading(false);
        setDisplayCounter(false);
        alert("Error minting NFT. Please try again.");
      });
};
```

### ðŸ” Code Breakdown

- **Validates if `userName` is entered** before proceeding.
- **Sends a transaction** to request an NFT using `requestNFT(userName)`.
- **Handles transaction events** like `transactionHash`, `receipt`, and `error`.
- **Calls `checkNewMinted()`** to verify the minting status.

## ðŸ” Did You Mint? â€“ checkMinted()

Now, let's check if the user has minted an NFT:

```javascript
const checkMinted = async () => {
  await checkName();
  const minted = await randomHouseContract.methods.hasMintedNFT(account).call();
  console.log(minted);

  if (minted) {
    setMinted(true);
    await getHouseData();
  } else {
    setMinted(false);
  }
  setLoading(false);
  setResponseLoading(false);
};
```

### ðŸ§ Whatâ€™s Happening?
- Calls `checkName()` to get the user's name.
- Calls `hasMintedNFT` from the smart contract to check minting status.
- If `minted`, updates UI and retrieves house data.
- Resets loading states.

## ðŸ†” Who Are You? â€“ checkName()

This function retrieves the user's name:

```javascript
const checkName = async () => {
  setLoading(true);
  const name = await randomHouseContract.methods.s_addressToName(account).call();
  if (name) {
    setUserName(name);
    setIsUserNameSubmitted(true);
  }
  console.log("Name set");
};
```

### ðŸ·ï¸ What Does This Do?
- Calls `s_addressToName` to get the name.
- Updates UI with the retrieved name.
- Logs confirmation.

## ðŸ”„ Auto-Check Minting Status â€“ checkNewMinted()

Now, let's periodically check if a user has minted an NFT:

```javascript
const checkNewMinted = async () => {
  setDisplayCounter(true);
  let retries = 0;
  const maxRetries = 10;
  
  while (retries < maxRetries) {
    console.log(`Checking NFT status (attempt ${retries + 1}/${maxRetries})...`);
    try {
      const minted = await randomHouseContract.methods.hasMintedNFT(account).call();
      if (minted) {
        console.log("NFT minted successfully!");
        setMinted(true);
        await getHouseData();
        await checkName();
        break;
      }
      console.log(`NFT not ready yet, retrying in 8 seconds... (attempt ${retries + 1}/${maxRetries})`);
      await new Promise(resolve => setTimeout(resolve, 8000));
      retries++;
    } catch (err) {
      console.error("Error checking NFT status:", err);
      await new Promise(resolve => setTimeout(resolve, 5000));
      retries++;
    }
  }
  setDisplayCounter(false);
};
```

### ðŸ¤– Whatâ€™s This Doing?
- **Retries up to 10 times** to check minting status.
- **Calls `hasMintedNFT`** to verify if NFT is minted.
- **If minted**, updates UI and fetches house data.
- **Waits 8 seconds between retries** for transaction confirmation.

## ðŸŽ¯ Whatâ€™s Next?

We just added some ðŸ”¥ features: âœ… Users can request an NFT.
âœ… The app automatically checks for minting status.
âœ… Users can verify if their NFT is minted.
âœ… The UI updates dynamically with real-time data.

Next, weâ€™ll add final UI enhancements and prepare for deployment! ðŸŒŽ Stay tuned! ðŸš€
